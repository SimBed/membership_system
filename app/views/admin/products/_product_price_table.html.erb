<table class="table table-secondary table-striped caption-top">
  <caption>Product Categories</caption>
  <tbody>
    <tr>
      <th scope="col">Name</th>
      <th scope="col">ID</th>
      <th scope="col">COUNT</th>
      <th scope="col">Discount</th>
      <th scope="col">Base Price</th>
      <th scope="col">From</th>
      <th scope="col">Until</th>
      <th scope="col">Status</th>
      <th scope="col">Purpose</th>
      <th colspan="3"><%= link_to image_tag('add.png', class:'table_icon'), new_admin_price_path(product_id: params[:id]) %></th>
    </tr>
<% @prices.each do |price| %>
      <tr>
        <th scope="row" class="fw-light" style="color: <%='red' if price.pre_oct22_price?%>"><%= price.name %></th>
        <td><%= price.id %></td>
        <td><%= Purchase.where(price_id:price).size %></td>
        <td><%= discount_format(price.discount) %></td>
        <td><%= number_with_delimiter(price.price) %></td>
        <td><%= price.date_from.strftime('%d %b %y') %></td>
        <td><%= ((price.date_until || Date.today) - Date.today > 3650) ? raw("&infin;") :price.date_until&.strftime('%d %b %y') %></td>
        <td><%= price.current? ? 'current' : 'old' %></td>
        <td><%= purpose(price) %></td>
        <td><%= link_to image_tag('attendances.png', class: ["table_icon",("active-workout" unless price.current?)].compact.join(' ')), admin_price_path(price, current: !price.current?, product_id: params[:id] ), method: :patch %></td>                    
        <td><%= link_to image_tag('edit.png', class: "table_icon"), edit_admin_price_path(price)%></td>
        <td><%= link_to image_tag('delete.png', class: "table_icon"), admin_price_path(price), method: :delete, data: { confirm: 'Price will be deleted. Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
  <caption style="caption-side: bottom">Prices from before October 22 used a different design and are shown in red. For these, The Price's price is correctly shown, but may not be reconcilable as base price x discount.</caption>
</table>
